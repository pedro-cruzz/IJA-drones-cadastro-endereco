{% extends "base.html" %}
{% block content %}

<div class="container mt-4">
Â  Â  <h2 class="text-dark">
Â  Â  Â  Â  ðŸ“… Agenda de Agendamentos
Â  Â  </h2>
Â  Â  <hr>

Â  Â  <div id="calendar"></div>
</div>

<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>

<script id="eventos-dados" type="application/json">
    {{ eventos_json | safe }}
</script>

<script>
document.addEventListener('DOMContentLoaded', function () {
    
    // 2. Leitura e conversÃ£o do JSON armazenado
    const eventosDadosRaw = document.getElementById('eventos-dados').textContent;
    // O array de eventos serÃ¡ carregado aqui, eliminando o erro de sintaxe
    let eventos;
    try {
        eventos = JSON.parse(eventosDadosRaw);
    } catch (e) {
        console.error("Erro ao carregar dados JSON para o FullCalendar:", e);
        eventos = []; // Define como array vazio para evitar quebrar o calendÃ¡rio
    }


Â  Â  var calendarEl = document.getElementById('calendar');

Â  Â  var calendar = new FullCalendar.Calendar(calendarEl, {
Â  Â  Â  Â  initialView: 'dayGridMonth',
Â  Â  Â  Â  locale: 'pt-br',
Â  Â  Â  Â  headerToolbar: {
Â  Â  Â  Â  Â  Â  left: 'prev,next today',
Â  Â  Â  Â  Â  Â  center: 'title',
Â  Â  Â  Â  Â  Â  right: 'dayGridMonth,timeGridWeek,listWeek'
Â  Â  Â  Â  },

Â  Â  Â  Â  // 3. Passa a variÃ¡vel JS (o array) diretamente
Â  Â  Â  Â  events: eventos,

Â  Â  Â  Â  // Adiciona tooltip com o tÃ­tulo completo
Â  Â  Â  Â  eventDidMount: function(info) {
Â  Â  Â  Â  Â  Â  info.el.setAttribute("title", info.event.title);
Â  Â  Â  Â  }
Â  Â  });

Â  Â  calendar.render();
});
</script>

{% endblock %}